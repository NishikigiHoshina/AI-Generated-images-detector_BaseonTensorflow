<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake News Detector</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const dropArea = document.querySelector('.image-upload');
            const fileInput = document.getElementById('image_file');

            // é˜»æ­¢é»˜è®¤çš„æ‹–æ‹½è¡Œä¸º
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            // é«˜äº®æ˜¾ç¤ºæ‹–æ‹½åŒºåŸŸ
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });

            function highlight(e) {
                dropArea.style.backgroundColor = '#f0f0f0';
            }

            function unhighlight(e) {
                dropArea.style.backgroundColor = '';
            }

            // å¤„ç†æ–‡ä»¶æ‹–æ‹½ä¸Šä¼ 
            dropArea.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;

                if (files.length > 0) {
                    fileInput.files = files;
                }
            }

            // å¤„ç†ç‚¹å‡»ä¸Šä¼ 
            dropArea.addEventListener('click', function () {
                fileInput.click();
            });
        });
    </script>
</head>
<body>
    <a href="{{ url_for('videopredict') }}" class="btn">è§†é¢‘æ£€æµ‹</a>
    <div class="container">
        <h1>Fake Detector</h1>
        <form method="post" action="/predicttext">
            <div class="form-group">
                <label for="news_text">æ–°é—»æ–‡æœ¬å†…å®¹</label>
                <textarea id="news_text" name="news_text" placeholder="è¯·è¾“å…¥æ–°é—»æ–‡ç« å†…å®¹..." required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">æ£€æµ‹çœŸä¼ª</button>
        </form>
        <!-- æ‹–æ‹½æ–‡ä»¶ä¸Šä¼ èŒƒä¾‹ä»£ç   éœ€è¦æ­é…scripts -->
        <form method="POST" action="/predictimg" enctype="multipart/form-data">
            <div class="form-group image-upload">
                <div class="upload-icon">ğŸ“·</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ å›¾ç‰‡</div>
                <div class="upload-subtext">æ”¯æŒ PNG, JPG, JPEG, GIF æ ¼å¼</div>
                <input type="file" id="image_file" name="image_file" accept="image/*">
            </div>
            
            <button type="submit" class="btn btn-primary">æ£€æµ‹çœŸä¼ª</button>
        </form>
        
        {% if prediction or image_prediction or error_msg %}
        <div class="results">
            {% if error_msg %}
            <div class="result-card" style="border-left: 4px solid #f39c12;">
                <p style="color: #e74c3c; font-weight: bold;">é”™è¯¯æç¤º:</p>
                <p>{{ error_msg }}</p>
            </div>
            {% endif %}
            
            {% if prediction %}
            <div class="result-card {% if prediction == 'Fake' %}prediction-fake{% else %}prediction-real{% endif %}">
                <h2 class="prediction-text">æ–‡æœ¬æ£€æµ‹ç»“æœ: {{ prediction }}</h2>
                <div class="news-preview">æ–°é—»æ–‡æœ¬: {{ news_text }}</div>
            </div>
            {% endif %}
            
            {% if image_prediction %}
            <div class="result-card {% if image_prediction == 'Fake' %}prediction-fake{% else %}prediction-real{% endif %}">
                <h2 class="prediction-text">å›¾ç‰‡æ£€æµ‹ç»“æœ: {{ image_prediction }}</h2>
                {% if image_path %}
                <img src="{{ image_path }}" alt="ä¸Šä¼ çš„å›¾ç‰‡" class="image-preview">
                {% endif %}
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
</body>
</html>